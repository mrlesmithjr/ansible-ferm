---
# defaults file for ansible-ferm
ferm_custom_chains:
  - ALLOWED-LOGGING
  - ALLOWED-NO-LOGGING
ferm_table_filters:
  - chain: FORWARD
    policy: DROP
    connection_tracking:
      - state: INVALID
        policy: DROP
      - state: ESTABLISHED
        policy: ACCEPT
      - state: RELATED
        policy: ACCEPT
    rules: []
  - chain: INPUT  #define rules to be applied in-bound...name's should be unique (files generated by weight/name)
    policy: DROP
    allow_local_connections: true  #defines if local loopback connections should be allowed.
    connection_tracking:
      - state: INVALID
        policy: DROP
      - state: ESTABLISHED
        policy: ACCEPT
      - state: RELATED
        policy: ACCEPT
    rules:
      - name: allow_ping_in
        proto: icmp
        source: 0.0.0.0/0
        destination: 0.0.0.0/0
        target: ACCEPT
        weight: '000'  #defines the default rule weight for rules that do not specify it. (000=highest,999=lowest)
      - name: allow_ssh_in
        proto: tcp
        source: 0.0.0.0/0
        destination: 0.0.0.0/0
        dport: 22
        target: ACCEPT
        jump: ALLOWED-LOGGING  #defines a jump rule to set as target...defined in ferm_custom_chains
        weight: '000'
      - name: allow_ipsec_in
        proto: udp
        dport: 500
        target: ACCEPT
        weight: '000'
      - name: allow_ipsec_in
        proto: esp
        target: ACCEPT
        weight: '000'
      - name: allow_ipsec_in
        proto: ah
        target: ACCEPT
        weight: '000'
  - chain: OUTPUT
    policy: ACCEPT
    connection_tracking:
      - state: INVALID
        policy: DROP
      - state: ESTABLISHED
        policy: ACCEPT
      - state: RELATED
        policy: ACCEPT
    rules: []
ferm_targets:
